<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
    <meta name="google" content="notranslate">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>HSK3 Bab 17 ¬∑ Ë∞ÅÈÉΩÊúâÂäûÊ≥ïÁúãÂ•Ω‰Ω†ÁöÑ‚ÄúÁóÖ‚Äù</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        body {
            font-family: 'Comic Neue', 'Segoe UI', 'ÂæÆËΩØÈõÖÈªë', cursive, sans-serif;
            background: linear-gradient(145deg, #f9e7b3 0%, #f5d0a9 100%);
            min-height: 100vh;
            padding: 15px;
            color: #3e2a1f;
            -webkit-touch-callout: none;
        }
        input, textarea {
            user-select: text;
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
        }
        #identityOverlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }
        .identity-card {
            background: #ffd966;
            padding: 40px;
            border-radius: 80px;
            border: 8px solid #e67e22;
            box-shadow: 0 20px 0 #b86f2c;
            text-align: center;
            max-width: 90%;
            width: 500px;
        }
        .identity-card h2 {
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 30px;
            text-shadow: 3px 3px 0 #f1c40f;
        }
        .identity-card input {
            width: 100%;
            padding: 20px;
            font-size: 2rem;
            border-radius: 60px;
            border: 5px solid #e67e22;
            background: #fff7e0;
            text-align: center;
            font-family: inherit;
            margin-bottom: 30px;
        }
        .identity-card button {
            background: #e67e22;
            border: none;
            color: white;
            font-size: 2.2rem;
            padding: 15px 50px;
            border-radius: 60px;
            font-weight: bold;
            border-bottom: 8px solid #b86f2c;
            cursor: pointer;
        }
        .identity-card button:active {
            border-bottom-width: 3px;
            transform: translateY(5px);
        }
        .header {
            background: #ffd966;
            padding: 15px 25px;
            border-radius: 60px 60px 20px 20px;
            box-shadow: 0 10px 0 #b86f2c, 0 8px 15px rgba(0,0,0,0.2);
            margin-bottom: 25px;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
            border: 4px solid #f1c40f;
            background-image: repeating-linear-gradient(45deg, #ffe28a 0px, #ffe28a 10px, #ffd966 10px, #ffd966 20px);
        }
        .header h1 {
            font-size: 2rem;
            text-shadow: 3px 3px 0 #b86f2c;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        .header h1 span:last-child {
            font-size: 1.2rem;
            background: #2c3e50;
            color: #f1c40f;
            padding: 5px 15px;
            border-radius: 40px;
            border: 2px solid #e67e22;
        }
        .timer {
            background: #2c3e50;
            color: #f1c40f;
            font-size: 2.2rem;
            font-weight: bold;
            padding: 10px 25px;
            border-radius: 50px;
            border: 4px solid #e67e22;
            box-shadow: inset 0 -3px 0 #1a2632, 0 8px 0 #9b5e1e;
            font-family: 'Courier New', monospace;
        }
        .tab-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .tab {
            flex: 1;
            text-align: center;
            padding: 18px 0;
            font-size: 1.8rem;
            font-weight: bold;
            background: #f39c12;
            color: #2c3e50;
            border-radius: 40px 40px 0 0;
            border: 4px solid #d35400;
            border-bottom: none;
            cursor: pointer;
            transition: 0.2s;
            box-shadow: 0 -5px 0 #b86f2c;
            text-shadow: 2px 2px 0 #f1c40f;
        }
        .tab.active {
            background: #f1c40f;
            transform: scale(1.02);
            border-color: #e67e22;
            box-shadow: 0 -8px 0 #b86f2c;
        }
        .content-panel {
            background: rgba(255, 250, 210, 0.9);
            border: 5px solid #e67e22;
            border-radius: 30px 30px 30px 30px;
            padding: 25px 15px;
            box-shadow: 0 15px 0 #b86f2c, inset 0 2px 15px #ffeeaa;
            backdrop-filter: blur(2px);
            margin-bottom: 20px;
        }
        .soal-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
        }
        .soal-card {
            background: #feebc0;
            border: 4px solid #e67e22;
            border-radius: 35px;
            padding: 20px 15px;
            box-shadow: 0 8px 0 #b86f2c, 0 5px 10px rgba(0,0,0,0.2);
            transition: 0.1s ease;
            position: relative;
        }
        .soal-nomor {
            background: #e67e22;
            color: white;
            display: inline-block;
            padding: 8px 20px;
            border-radius: 50px;
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 15px;
            border: 3px solid #f1c40f;
            box-shadow: inset 0 -3px 0 #a0531a;
        }
        .soal-text {
            font-size: 1.3rem;
            margin-bottom: 15px;
            background: #fff2d7;
            padding: 12px;
            border-radius: 25px;
            border: 2px dashed #e67e22;
        }
        .btn-play {
            background: #2ecc71;
            border: none;
            color: white;
            font-size: 1.3rem;
            padding: 8px 20px;
            border-radius: 40px;
            cursor: pointer;
            margin: 10px 0;
            font-weight: bold;
            border-bottom: 5px solid #1e8b4c;
            transition: 0.05s linear;
            box-shadow: 0 3px 8px rgba(0,0,0,0.2);
        }
        .btn-play:active {
            border-bottom-width: 2px;
            transform: translateY(3px);
        }
        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 15px;
        }
        .option-item {
            background: #fef9e7;
            border: 3px solid #d35400;
            border-radius: 50px;
            padding: 10px 15px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: 0.1s;
        }
        .option-item.selected {
            background: #f1c40f;
            border-color: #c0392b;
            box-shadow: 0 0 0 3px #f39c12;
        }
        input[type="radio"] {
            width: 22px;
            height: 22px;
            accent-color: #e67e22;
            pointer-events: none;
        }
        input[type="text"] {
            flex: 1;
            padding: 12px;
            border-radius: 50px;
            border: 3px solid #d35400;
            font-size: 1.2rem;
            background: #fffcf0;
            font-family: 'Comic Neue', 'ÂæÆËΩØÈõÖÈªë', cursive;
        }
        .btn-submit {
            background: #e67e22;
            color: white;
            font-size: 2.2rem;
            font-weight: bold;
            padding: 20px 40px;
            border: none;
            border-radius: 80px;
            cursor: pointer;
            margin: 20px auto 10px;
            display: block;
            border-bottom: 8px solid #b86f2c;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
            transition: 0.05s linear;
            width: fit-content;
        }
        .btn-submit:active {
            border-bottom-width: 3px;
            transform: translateY(5px);
        }
        .laporan {
            background: #2c3e50;
            color: #f1c40f;
            padding: 25px;
            border-radius: 50px;
            margin-top: 30px;
            border: 6px solid #e67e22;
            font-size: 1.6rem;
        }
        .btn-review {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 1.4rem;
            margin: 10px;
            border-bottom: 5px solid #1f5a8a;
            cursor: pointer;
        }
        .wrong-highlight {
            border: 6px solid #e74c3c !important;
            background: #fadbd8 !important;
        }
        .correct-highlight {
            border: 6px solid #2ecc71 !important;
            background: #d5f5e3 !important;
        }
        .footer {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        @media (max-width: 700px) {
            .header { flex-direction: column; text-align: center; }
            .timer { font-size: 1.8rem; }
        }
    </style>
</head>
<body translate="no" oncontextmenu="return false;" oncopy="return false;" oncut="return false;" onpaste="return false;">

<div id="identityOverlay">
    <div class="identity-card">
        <h2>‚öîÔ∏è ËØ∑ËæìÂÖ•ÊÇ®ÁöÑÂêçÂ≠ó ‚öîÔ∏è</h2>
        <input type="text" id="userNameInput" placeholder="ÊÇ®ÁöÑÂêçÂ≠ó" autocomplete="off">
        <button onclick="startApp()">ÂºÄÂßãÁªÉ‰π†</button>
    </div>
</div>

<div class="header">
    <h1>
        <span>‚ö° HSK3 Á¨¨ÂçÅ‰∏ÉËØæ</span>
        <span>by lcnpalembang-08994477998</span>
    </h1>
    <div class="timer" id="timerDisplay">40:00</div>
</div>

<div class="tab-container">
    <div class="tab active" id="tabListening" onclick="switchTab('listening')">üéß Âê¨Âäõ</div>
    <div class="tab" id="tabReading" onclick="switchTab('reading')">üìñ ÈòÖËØª</div>
</div>

<div id="listeningPanel" class="content-panel"></div>
<div id="readingPanel" class="content-panel" style="display: none;"></div>

<button class="btn-submit" id="submitBtn" onclick="submitAll()">‚ú® Êèê‰∫§Á≠îÊ°à ‚ú®</button>

<div id="laporanArea" class="laporan" style="display: none;"></div>

<script>
    (function() {
        // NONAKTIFKAN GOOGLE TRANSLATE DENGAN ATRIBUT
        let userName = '';

        // Data kunci jawaban (asli, berdasarkan nomor soal)
        const listeningJawaban = {
            1:'E',2:'F',3:'A',4:'B',5:'C',
            6:'ÂØπ',7:'Èîô',8:'ÂØπ',9:'Èîô',10:'Èîô',
            11:'C',12:'A',13:'C',14:'C',15:'B',
            16:'A',17:'C',18:'C',19:'C',20:'B'
        };

        const readingJawaban = {
            21:'C',22:'D',23:'B',24:'F',25:'A',
            26:'C',27:'D',28:'B',29:'F',30:'A',
            31:'B',32:'A',33:'C',34:'C',35:'A',
            36:'ÂºüÂºüÈ´òÂÖ¥ÂæóË∑≥‰∫ÜËµ∑Êù•',37:'Â∞èÁãóÁöÑÁúºÁùõÂ§ßÂ§ßÁöÑ',38:'ÊòéÂ§©Â§©Ê∞îÂ•ΩÊàë‰ª¨Â∞±ÂéªÂÖ¨Âõ≠Áé©ÂÑø',39:'ÊàëÁöÑËÖøÁñºÂæó‰∏çËÉΩËµ∞Ë∑Ø',40:'Ê∞¥ÊûúÂ∫óÁöÑË•øÁìúÁîúÁîúÁöÑ',
            41:'Âüé',42:'ÁöÆ',43:'Èºª',44:'Ê£Ä',45:'Áâô',
            46:'Á±≥',47:'Â¶Ç',48:'Ëøë',49:'Êü•',50:'ÂÜí'
        };

        const normalisasiKalimat = (s) => s.replace(/\s+/g, '').replace(/[Ôºå„ÄÇÔºÅÔºü„ÄÅ]/g, '');

        // Opsi dalam Mandarin untuk listening (tetap, tidak diacak)
        const opsiMandarin = {
            1: ['A: Êó©È§êÂè™ÂñùÂíñÂï°ÂêÉËõãÁ≥ï', 'B: ÈÇªÂ±Ö‰∫íÁõ∏‰ªãÁªç', 'C: Â≠©Â≠ê‰ª¨Áé©Èõ™', 'D: ÊâìÁîµËØù', 'E: Áî∑ÁöÑÊÉ≥Áò¶Â∞ëÂêÉ', 'F: Ë∑ëÊ≠•ÂêéËÖøÁñº'],
            2: ['A: Êó©È§êÂè™ÂñùÂíñÂï°ÂêÉËõãÁ≥ï', 'B: ÈÇªÂ±Ö‰∫íÁõ∏‰ªãÁªç', 'C: Â≠©Â≠ê‰ª¨Áé©Èõ™', 'D: ÊâìÁîµËØù', 'E: Áî∑ÁöÑÊÉ≥Áò¶Â∞ëÂêÉ', 'F: Ë∑ëÊ≠•ÂêéËÖøÁñº'],
            3: ['A: Êó©È§êÂè™ÂñùÂíñÂï°ÂêÉËõãÁ≥ï', 'B: ÈÇªÂ±Ö‰∫íÁõ∏‰ªãÁªç', 'C: Â≠©Â≠ê‰ª¨Áé©Èõ™', 'D: ÊâìÁîµËØù', 'E: Áî∑ÁöÑÊÉ≥Áò¶Â∞ëÂêÉ', 'F: Ë∑ëÊ≠•ÂêéËÖøÁñº'],
            4: ['A: Êó©È§êÂè™ÂñùÂíñÂï°ÂêÉËõãÁ≥ï', 'B: ÈÇªÂ±Ö‰∫íÁõ∏‰ªãÁªç', 'C: Â≠©Â≠ê‰ª¨Áé©Èõ™', 'D: ÊâìÁîµËØù', 'E: Áî∑ÁöÑÊÉ≥Áò¶Â∞ëÂêÉ', 'F: Ë∑ëÊ≠•ÂêéËÖøÁñº'],
            5: ['A: Êó©È§êÂè™ÂñùÂíñÂï°ÂêÉËõãÁ≥ï', 'B: ÈÇªÂ±Ö‰∫íÁõ∏‰ªãÁªç', 'C: Â≠©Â≠ê‰ª¨Áé©Èõ™', 'D: ÊâìÁîµËØù', 'E: Áî∑ÁöÑÊÉ≥Áò¶Â∞ëÂêÉ', 'F: Ë∑ëÊ≠•ÂêéËÖøÁñº'],
            11: ['A: ‰∏§Áì∂ÁâõÂ•∂', 'B: ‰∏ÄÊù°È±º', 'C: ‰ªÄ‰πàÈÉΩÊ≤°‰π∞'],
            12: ['A: Âè£Ê∏¥', 'B: ‰ªÄ‰πàÈÉΩ‰∏çÊÉ≥Âñù', 'C: ‰∏çÊÉ≥ÂñùÂÜ∞Ê∞¥'],
            13: ['A: ÂõΩÂ§ñ', 'B: ÂæàÂ§öÂüéÂ∏Ç', 'C: ‰ªÄ‰πàÂú∞ÊñπÈÉΩÊ≤°Âéª'],
            14: ['A: ËßâÂæóËÄÉËØï‰∏çÂÆπÊòì', 'B: ÂÜôÂæóÂæàÊÖ¢', 'C: È¢òÈÉΩÊ£ÄÊü•Ëøá‰∫Ü'],
            15: ['A: ÁªèÁêÜÂíåÁßò‰π¶', 'B: ÂåªÁîüÂíåÁóÖ‰∫∫', 'C: ‰∏àÂ§´ÂíåÂ¶ªÂ≠ê'],
            16: ['A: ÁªèÂ∏∏‰∏çÊù•‰∏äËØæ', 'B: ‰ªÄ‰πàÈÉΩÂê¨ÂæóÊáÇ', 'C: Ê≤°ËØ∑ËøáÂÅá'],
            17: ['A: Â§©Ê∞îÂæàÂ•Ω', 'B: ÂñúÊ¨¢Êñ∞Èóª', 'C: ÂáÜÂ§áËÄÉËØï'],
            18: ['A: ÊÉ≥ÂéªÈ•≠È¶ÜÂêÉ', 'B: ‰∏çÊÉ≥ÂêÉÁâõËÇâ', 'C: ‰ªÄ‰πàÈÉΩÂñúÊ¨¢ÂêÉ'],
            19: ['A: ÂñúÊ¨¢ÈÇ£ÈáåÁöÑÂÜ¨Â§©', 'B: ‰∏çÂñúÊ¨¢ÈÇ£ÈáåÁöÑÂ≠¶‰π†ÁéØÂ¢É', 'C: ‰∏ç‰π†ÊÉØÈÇ£ÈáåÁöÑÂ§©Ê∞î'],
            20: ['A: ÂùêÁùÄ‰∏äËØæ', 'B: ÊòØËÄÅÂ∏à', 'C: ‰ªÄ‰πàÂú∞ÊñπÈÉΩÊÉ≥Âéª']
        };

        // Data teks listening untuk speech
        const listeningScript = {
            1: "Â•≥Ôºö‰Ω†ÁöÑÊó©È•≠Âè™Êúâ‰∏ÄÊùØÂíñÂï°Âíå‰∏ÄÂ∞èÂùóËõãÁ≥ïÔºåÂêÉ‰∏çÈ•±„ÄÇË¶Å‰∏çË¶ÅÂÜçÊù•‰∏Ä‰∏™È∏°ËõãÊàñËÄÖÊ∞¥ÊûúÔºüÁî∑ÔºöÊ≤°ÂäûÊ≥ïÔºå‰∏∫‰∫ÜÁò¶‰∏ÄÁÇπÂÑøÔºåÊàëÂøÖÈ°ªÂ∞ëÂêÉ„ÄÇ",
            2: "Áî∑ÔºöÈõ™‰∏ãÂæóÁúüÂ§ßÔºåË∞ÅÈÉΩÊ≤°ÊÉ≥Âà∞‰ªäÂπ¥ÂÜ¨Â§©ËÉΩ‰∏ãËøô‰πàÂ§ßÁöÑÈõ™„ÄÇÂ•≥ÔºöÊòØÂïäÔºå‰Ω†ÁúãÂ≠©Â≠ê‰ª¨Áé©ÂÑøÂæóÂ§öÈ´òÂÖ¥„ÄÇ",
            3: "Áî∑1ÔºöÁªèÁêÜÔºå‰∏ã‰∏™ÊòüÊúüÊàëÊÉ≥ËØ∑‰∏âÂ§©ÂÅáÔºåÂèØ‰ª•ÂêóÔºüÁî∑2ÔºöËøô‰∏™Êúà‰Ω†Â∑≤ÁªèËØ∑‰∫Ü‰∏§‰∏™ÊòüÊúüÂÅá‰∫ÜÔºå‰∏çËÉΩÂÜçËØ∑‰∫Ü„ÄÇ",
            4: "Áî∑Ôºö‰Ω†‰ª¨Â•ΩÔºåÊàëÊòØ‰Ω†‰ª¨ÁöÑÊñ∞ÈÇªÂ±ÖÔºåÊò®Â§©ÂàöÊê¨ËøáÊù•„ÄÇËøôÊòØÊàëÂ¶ªÂ≠ê„ÄÇÂ•≥ÔºöÊ¨¢Ëøé‰Ω†‰ª¨ÔºÅËøôÊòØÊàë‰∏àÂ§´„ÄÇÊàë‰ª¨Âú®ËøôÂÑø‰Ωè‰∫Ü‰∫îÂπ¥‰∫ÜÔºåÂØπËøôÂÑøÂæà‰∫ÜËß£Ôºå‰ª•ÂêéÊúâ‰ªÄ‰πàÈóÆÈ¢òÈÉΩÂèØ‰ª•Êù•ÊâæÊàë‰ª¨„ÄÇ",
            5: "Â•≥ÔºöÁé©ÂÑø‰∫ÜËøô‰πàÈïøÊó∂Èó¥ÔºåÊàëÊ∏¥‰∫ÜÔºåÊàëÂÖàÂñùÁÇπÂÑøÊ∞¥„ÄÇ‰Ω†‰∏çÊ∏¥ÂêóÔºüÁî∑ÔºöÊàë‰∏çÊ∏¥Ôºå‰Ω†ÂñùÂêßÔºåÊàëÁ≠â‰ºöÂÑø‰Ω†„ÄÇÂñùÂÆå‰∫ÜÊàë‰ª¨ÂéªÂâçËæπÁé©ÂÑø„ÄÇ",
            6: "ÊòéÂ§©Êó©‰∏äËØ∑Â§ßÂÆ∂8ÁÇπ‰ª•ÂâçÂà∞ÂÖ¨Âè∏‰ºöËÆÆÂÆ§ÔºåÂÅöÂ•ΩÂºÄ‰ºöÁöÑÂáÜÂ§á„ÄÇÊòéÂ§©ÁöÑ‰ºöËÆÆÈùûÂ∏∏ÈáçË¶ÅÔºåË∞ÅÈÉΩ‰∏çËÉΩËøüÂà∞Ôºå‰πü‰∏çËÉΩËØ∑ÂÅá„ÄÇ",
            7: "‰∏∫‰∫ÜÊñπ‰æøÂ§ßÂÆ∂ÔºåÊ•º‰∏ãÊñ∞ÂºÄ‰∫Ü‰∏ÄÂÆ∂ËçØÂ∫óÔºå24Â∞èÊó∂‰∏ç‰ºëÊÅØÔºå‰ªÄ‰πàÊó∂ÂÄôÂéªÈÉΩËÉΩ‰π∞Âà∞ËçØÔºåÂá†ÁÇπÂéªÈÉΩÊúâ‰∫∫Â∑•‰Ωú„ÄÇ",
            8: "Êàë‰ª¨Âú®ÁîüÊ¥ª‰∏≠ÈÅáÂà∞ÈóÆÈ¢òÊó∂Ôºå‰∏çËÉΩ‰ªÄ‰πà‰∫ãÊÉÖÈÉΩËØ∑Âà´‰∫∫Â∏ÆÂøôÔºåÂõ†‰∏∫Êúâ‰∫õ‰∫ãÊÉÖÂøÖÈ°ªË¶ÅËá™Â∑±Êù•ÂÅöÈÄâÊã©ÂíåÂÜ≥ÂÆö„ÄÇ",
            9: "Â≠¶Ê†°Ëøô‰∏™Â≠¶ÊúüË¶Å‰∏æË°å‰∏ÄÊ¨°Ê±âÂ≠óÊØîËµõÔºåÊØîËµõÊòØÊ†πÊçÆË¶ÅÊ±ÇÂÜôÊ±âÂ≠óÔºå‰∏ÄÂÖ±ÂÜô100‰∏™ÔºåË∞ÅÊúâÂÖ¥Ë∂£ÈÉΩÂèØ‰ª•ÂèÇÂä†„ÄÇ",
            10: "Â§ßÂÆ∂Â•ΩÔºåËøô‰∏™Â≠¶ÊúüÊàë‰ª¨Áè≠Êñ∞Êù•‰∫Ü2‰∏™ÂêåÂ≠¶Ôºå‰∏ÄÂÖ±21‰∏™Â≠¶Áîü„ÄÇÁé∞Âú®ÔºåËØ∑Êñ∞ÂêåÂ≠¶ÁªôÂ§ßÂÆ∂‰ªãÁªç‰ªãÁªçËá™Â∑±ÔºåÂ§ßÂÆ∂Ê¨¢Ëøé„ÄÇ",
            11: "Áî∑Ôºö‰Ω†‰∏çÊòØÂéªË∂ÖÂ∏ÇÂêóÔºüÊÄé‰πà‰ªÄ‰πàÈÉΩÊ≤°‰π∞ÔºüÂ•≥ÔºöÊàëÂú®Ë∂ÖÂ∏ÇÈáåÊãø‰∫Ü‰∏§Áì∂ÁâõÂ•∂Ôºå‰∏â‰∏™Èù¢ÂåÖÔºåËøòÊãø‰∫ÜÊù°È±º„ÄÇÂêéÊù•ÂèëÁé∞Ê≤°Â∏¶Èí±ÂåÖÔºåÂè™Â•ΩÈÉΩÊîæÂõûÂéª‰∫Ü„ÄÇ",
            12: "Â•≥ÔºöËµ∞‰∫ÜËøô‰πàÈïøÊó∂Èó¥ÔºåÊ∏¥‰∫ÜÂêßÔºüÂø´Âùê‰∏ãÊù•‰ºëÊÅØ‰ºëÊÅØÔºå‰Ω†ÊÉ≥ÂñùÁÇπÂÑø‰ªÄ‰πàÔºüÁî∑ÔºöÂñù‰ªÄ‰πàÈÉΩË°åÔºåÂÖàÊù•ÊùØÂÜ∞Ê∞¥ÔºåÁÑ∂ÂêéÂÜçÁúãÁúãËøôÂÑøÊúâ‰ªÄ‰πàÂ•ΩÂñùÁöÑÈ•ÆÊñô„ÄÇ",
            13: "Áî∑ÔºöÂê¨ËØ¥‰Ω†Âíå‰∏àÂ§´ÂéªÊóÖÊ∏∏‰∫ÜÔºüÂéª‰∫ÜÂì™‰∫õÂú∞ÊñπÔºüÊÄé‰πàÊ†∑ÔºüÂ•≥ÔºöÊàë‰ª¨ÊâìÁÆóÂùêÈ£ûÊú∫ÂéªÂõΩÂ§ñÔºåÊâæ‰∏™ÂÆâÈùôÁöÑÂüéÂ∏ÇÔºåÂ•ΩÂ•Ω‰ºëÊÅØ‰ºëÊÅØÔºåÂêéÊù•ÂÑøÂ≠êÁîüÁóÖ‰∫ÜÔºå‰∏∫‰∫ÜÁÖßÈ°æ‰ªñÔºåÂì™ÂÑøÈÉΩÊ≤°Âéª„ÄÇ",
            14: "Â•≥ÔºöÂÜ¨ÂÜ¨Ôºå‰Ω†ÊÄé‰πàËøô‰πàÂø´Â∞±ËÄÉÂÆå‰∫ÜÔºüÂÅöÂÆåÈ¢òÂ∫îËØ•Ê£ÄÊü•Ê£ÄÊü•ÔºåÁúãÁúãÊúâÊ≤°ÊúâÂÜôÈîôÁöÑÂ≠ó„ÄÇÁî∑ÔºöÊàëÂ∑≤ÁªèÊ£ÄÊü•Ëøá‰∫ÜÔºå‰ªäÂ§©ÁöÑËÄÉËØïÈ¢òÁâπÂà´ÁÆÄÂçïÔºåÊâÄ‰ª•ÂæàÂø´Â∞±ÂÅöÂÆå‰∫Ü„ÄÇ",
            15: "Áî∑ÔºöÊàëÊò®Â§©Ë∑ëÂÆåÊ≠•‰ª•ÂêéÂ∞±‰∏ÄÁõ¥ËÖøÁñºÔºåËØ∑ÊÇ®Â∏ÆÊàëÊ£ÄÊü•Ê£ÄÊü•ÔºåÁúãÁúãÁî®‰∏çÁî®ÂêÉÁÇπÂÑøËçØ„ÄÇÂ•≥Ôºö‰Ω†Â§™‰πÖÊ≤°ËøêÂä®‰∫ÜÔºåÊâÄ‰ª•ËÖøÁñº„ÄÇ‰ª•ÂêéÂ§öÂá∫ÂéªËøêÂä®ËøêÂä®Ôºå‰∏çÁî®ÂêÉËçØ„ÄÇ",
            16: "Áî∑ÔºöËÄÅÂ∏àÔºåÊàëÂèØ‰ª•ËØ∑Âá†Â§©ÂÅáÂêóÔºüÂ•≥ÔºöÂ∞èÈõ®Ôºå‰Ω†ÁúãÁúãÔºåËøô‰∏™Â≠¶Êúü‰Ω†ÈÉΩËØ∑‰∫ÜÂá†Ê¨°ÂÅá‰∫ÜÔºüÁî∑ÔºöËÄÅÂ∏àÔºåÂØπ‰∏çËµ∑Ôºå‰∏ä‰∏™ÊúàÊòØÊàëÂ¶àÂ¶àÊù•Âåó‰∫¨ÔºåÊàëÂ∏¶Â•πÂú®‰∏≠ÂõΩÊóÖÊ∏∏ÔºåÁÑ∂ÂêéÊòØÊàëÂßêÂßêÊù•ÔºåÂâçÂá†Â§©ÊòØÊàëÁóÖ‰∫ÜÔºå‰∏ã‰∏™ÊòüÊúüÊàëÂ•≥ÊúãÂèãË¶ÅÊù•ÁúãÊàë„ÄÇÂ•≥ÔºöÂ∞èÈõ®ÔºåÂ¶ÇÊûú‰Ω†ÂÜç‰∏çÊù•‰∏äËØæÔºåÂ∞±‰ªÄ‰πàÈÉΩÂê¨‰∏çÊáÇ‰∫Ü„ÄÇ",
            17: "Â•≥Ôºö‰Ω†Âú®Âê¨Êñ∞ÈóªÔºüÂ§™Èò≥‰ªéË•øËæπÂá∫Êù•‰∫ÜÔºüÁî∑ÔºöÊàëÂØπÊñ∞ÈóªÊ≤°ÂÖ¥Ë∂£Ôºå‰∏ªË¶ÅÊòØÊÉ≥ÊèêÈ´òÊèêÈ´òÊàëÁöÑÊ±âËØ≠Ê∞¥Âπ≥„ÄÇÂ•≥Ôºö‰Ω†‰∏Ä‰∏™Â≠¶ÊúüÈÉΩÊ≤°ËÆ§ÁúüÂ≠¶‰π†‰∫ÜÔºåÁé∞Âú®ÊâçÂºÄÂßãÂä™ÂäõÔºüÁî∑ÔºöÊòéÂ§©Â∞±Ë¶ÅËÄÉËØï‰∫ÜÔºåÊàëË¶ÅÂ§ç‰π†Â§ç‰π†„ÄÇ",
            18: "Â•≥ÔºöÊàëÊúâÁÇπÂÑøÈ•ø‰∫ÜÔºåÊàë‰ª¨Âá∫ÂéªÊâæ‰∏™‰∫∫Â∞ëÁÇπÂÑøÁöÑÈ•≠È¶ÜÂêÉÈ•≠Âêß„ÄÇÁî∑ÔºöËøô‰∏™Êó∂Èó¥ÔºåÂì™‰∏™È•≠È¶Ü‰∫∫ÈÉΩÂ§öÔºåÊàë‰ª¨Âú®ÂÆ∂ÂêÉÂêßÔºåËá™Â∑±ÂÅö„ÄÇÂ•≥ÔºöÂ•ΩÔºåÂÆ∂ÈáåÊúâÈ±ºÔºåÊúâÈ∏°ËõãÔºåËøòÊúâÁâõËÇâ„ÄÇÁâõËÇâ‰Ω†ÊÉ≥ÊÄé‰πàÂêÉÔºüË∑üÈ∏°Ëõã‰∏ÄËµ∑ÂÅöËøòÊòØË∑üÂà´ÁöÑËèú‰∏ÄËµ∑ÂÅöÔºüÁî∑ÔºöÊÄé‰πàÂÅöÈÉΩË°åÔºåÊàë‰ªÄ‰πàÈÉΩÁà±ÂêÉ„ÄÇÈúÄË¶ÅÊàëÂ∏ÆÂøôÂêóÔºü",
            19: "Â•≥Ôºö‰Ω†Âú®ÂõΩÂ§ñÁïôÂ≠¶ËøôÂá†Âπ¥ÊÄé‰πàÊ†∑ÔºüÈÇ£ÈáåÁöÑÁîüÊ¥ª‰π†ÊÉØ‰∫ÜÂêóÔºüÁî∑ÔºöÈÇ£‰∏™Âú∞ÊñπÁöÑ‰∫∫ÂæàÁÉ≠ÊÉÖÔºåÂ≠¶‰π†ÁéØÂ¢É‰πü‰∏çÈîôÔºåÂ≠¶Ê†°ÈáåÊúâ‰∏§‰∏™Âõæ‰π¶È¶Ü„ÄÇ‰ΩÜÊòØÂ§©Ê∞îÊàëËøò‰∏çÂ§™‰π†ÊÉØ„ÄÇÂ•≥ÔºöÊÄé‰πàÔºüÈÇ£ÂÑøÁöÑÂ§©Ê∞îË∑üÊàë‰ª¨ËøôÂÑø‰∏ç‰∏ÄÊ†∑ÂêóÔºüÁî∑ÔºöÂÜ¨Â§©ÁâπÂà´ÈïøÔºå‰ªé11ÊúàÂà∞Á¨¨‰∫åÂπ¥3ÊúàÈÉΩÊØîËæÉÂÜ∑„ÄÇ‰∏ãÂ§ßÈõ™ÁöÑÊó∂ÂÄôÔºåÂì™ÂÑøÈÉΩ‰∏çËÉΩÂéªÔºåÂè™ËÉΩÂú®ÊàøÈó¥ÈáåÁúã‰π¶„ÄÇ",
            20: "Áî∑Ôºö‰Ω†Âú®Ê§ÖÂ≠ê‰∏äÂùê‰∫Ü‰∏Ä‰∏™Â§öÂ∞èÊó∂‰∫ÜÔºå‰∏ÄÂè•ËØùÈÉΩ‰∏çËØ¥ÔºåÊÄé‰πà‰∫ÜÔºüÂ•≥ÔºöÊàë‰∏ä‰∫Ü‰∏ÄÂ§©ËØæÔºåÁªôÂ≠¶ÁîüËÆ≤‰∏≠ÂõΩÂéÜÂè≤ÔºåÁé∞Âú®‰ªÄ‰πàÈÉΩ‰∏çÊÉ≥ËØ¥„ÄÇÁî∑ÔºöÈÇ£‰Ω†ÂÖà‰ºëÊÅØ‰ºëÊÅØÔºå‰∏Ä‰ºöÂÑøÊàëÂ∏¶‰Ω†Âá∫ÂéªÂêÉÈ•≠„ÄÇÂ•≥ÔºöÊàëÁé∞Âú®Âì™ÂÑøÈÉΩ‰∏çÊÉ≥ÂéªÔºåÂ∞±ÊÉ≥Âú®ÂÆ∂Áù°Ëßâ„ÄÇÊàë‰ª¨ÊôöÁÇπÂÑøÂÜçÂêÉÈ•≠Âêß„ÄÇ"
        };

        // State jawaban user
        let userAnswers = {};
        let timeLeft = 2400; // 40 menit
        let timerInterval;

        // Acak urutan per part
        let listeningOrder = {
            part1: [], // 1-5
            part2: [], // 6-10
            part3: [], // 11-15
            part4: []  // 16-20
        };
        let readingOrder = {
            part1: [], // 21-25
            part2: [], // 26-30
            part3: [], // 31-35
            part4: []  // 36-50
        };

        // Fungsi pengacak
        function shuffleArray(arr) {
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        // Inisialisasi urutan acak
        function initShuffledOrders() {
            // Listening
            listeningOrder.part1 = shuffleArray([1,2,3,4,5]);
            listeningOrder.part2 = shuffleArray([6,7,8,9,10]);
            listeningOrder.part3 = shuffleArray([11,12,13,14,15]);
            listeningOrder.part4 = shuffleArray([16,17,18,19,20]);
            // Reading
            readingOrder.part1 = shuffleArray([21,22,23,24,25]);
            readingOrder.part2 = shuffleArray([26,27,28,29,30]);
            readingOrder.part3 = shuffleArray([31,32,33,34,35]);
            readingOrder.part4 = shuffleArray([36,37,38,39,40,41,42,43,44,45,46,47,48,49,50]);
        }

        // Render listening sesuai urutan acak
        function renderListening() {
            const container = document.getElementById('listeningPanel');
            let html = '<div class="soal-grid">';
            // Gabungkan semua part berurutan sesuai urutan part (part1 dulu, part2, dll)
            const allParts = [listeningOrder.part1, listeningOrder.part2, listeningOrder.part3, listeningOrder.part4];
            for (let part of allParts) {
                for (let i of part) {
                    let optionsHtml = '';
                    if (i <= 5) {
                        let arr = opsiMandarin[i] || ['A','B','C','D','E','F'];
                        for (let idx = 0; idx < arr.length; idx++) {
                            let val = String.fromCharCode(65 + idx);
                            optionsHtml += `<div class="option-item" onclick="selectOption(${i}, '${val}')">
                                <input type="radio" name="q${i}" value="${val}" ${userAnswers[i] === val ? 'checked' : ''}> ${arr[idx]}
                            </div>`;
                        }
                    } else if (i >= 6 && i <= 10) {
                        optionsHtml = `
                            <div class="option-item" onclick="selectOption(${i}, 'ÂØπ')"><input type="radio" name="q${i}" value="ÂØπ" ${userAnswers[i] === 'ÂØπ' ? 'checked' : ''}> ‚úÖ ÂØπ</div>
                            <div class="option-item" onclick="selectOption(${i}, 'Èîô')"><input type="radio" name="q${i}" value="Èîô" ${userAnswers[i] === 'Èîô' ? 'checked' : ''}> ‚ùå Èîô</div>
                        `;
                    } else {
                        let arr = opsiMandarin[i] || ['A','B','C'];
                        optionsHtml = arr.map((text, idx) => {
                            let val = String.fromCharCode(65 + idx);
                            return `<div class="option-item" onclick="selectOption(${i}, '${val}')">
                                <input type="radio" name="q${i}" value="${val}" ${userAnswers[i] === val ? 'checked' : ''}> ${text}
                            </div>`;
                        }).join('');
                    }

                    html += `<div class="soal-card" id="soal-${i}">
                        <div class="soal-nomor">üéß ${i}</div>
                        <button class="btn-play" onclick="playListening(${i})">üîä Êí≠Êîæ</button>
                        <div class="options">${optionsHtml}</div>
                    </div>`;
                }
            }
            html += '</div>';
            container.innerHTML = html;
        }

        // Render reading sesuai urutan acak
        function renderReading() {
            const container = document.getElementById('readingPanel');
            let html = '<div class="soal-grid">';
            const allParts = [readingOrder.part1, readingOrder.part2, readingOrder.part3, readingOrder.part4];
            for (let part of allParts) {
                for (let i of part) {
                    let questionText = getReadingQuestionText(i);
                    let optionsHtml = '';

                    if (i >= 21 && i <= 25) {
                        let arr = [
                            'A ‰Ω†ÁöÑÈºªÂ≠êÁ∫¢Á∫¢ÁöÑÔºüÊÄé‰πà‰∫ÜÔºü',
                            'B ÊàëÁöÑÁâôÊúâÁÇπÂÑøÁñºÔºåÊÇ®Â∏ÆÊàëÁúãÁúãÂêß„ÄÇ',
                            'C ‰∏çÂà∞200Á±≥‰∫ÜÔºåÊàë‰ª¨Ë¶Å‰∏çË¶ÅÂÖà‰ºëÊÅØ‰∏Ä‰∏ãÔºü',
                            'D Êàë‰ª¨ÁªôÂ∞èÊñπÁöÑÂ≠©Â≠ê‰π∞ÁöÆÈûãËøòÊòØ‰π∞Â∏ΩÂ≠êÔºü',
                            'E ÂΩìÁÑ∂„ÄÇÊàë‰ª¨ÂÖàÂùêÂÖ¨ÂÖ±Ê±ΩËΩ¶ÔºåÁÑ∂ÂêéÊç¢Âú∞ÈìÅ„ÄÇ',
                            'F ‰ªñÊòØÊàë‰ª¨Â≠¶Ê†°ÁöÑÊ†°ÈïøÔºåÂßìÂë®„ÄÇ'
                        ];
                        optionsHtml = arr.map((txt, idx) => {
                            let val = String.fromCharCode(65 + idx);
                            return `<div class="option-item" onclick="selectOption(${i}, '${val}')">
                                <input type="radio" name="q${i}" value="${val}" ${userAnswers[i] === val ? 'checked' : ''}> ${txt}
                            </div>`;
                        }).join('');
                    } else if (i >= 26 && i <= 30) {
                        let arr = ['AÂüéÂ∏Ç','BÂ§¥Âèë','CÈºªÂ≠ê','DËÆ§‰∏∫','EÂ£∞Èü≥','FÂÖ≥Á≥ª'];
                        optionsHtml = arr.map((txt, idx) => {
                            let val = String.fromCharCode(65 + idx);
                            return `<div class="option-item" onclick="selectOption(${i}, '${val}')">
                                <input type="radio" name="q${i}" value="${val}" ${userAnswers[i] === val ? 'checked' : ''}> ${txt}
                            </div>`;
                        }).join('');
                    } else if (i >= 31 && i <= 35) {
                        let arr = (i === 31) ? ['A ‰∏çÂ§™ÈáçË¶Å','B Â∫îËØ•ÊØèÂπ¥‰∏ÄÊ¨°','C Ê≤°ÁóÖÁöÑ‰∫∫‰∏çÁî®‰ΩìÊ£Ä'] :
                                  (i === 32) ? ['A ÂëäËØâÂ§ßÂÆ∂','B ÂëäËØâÈ•≠Â∫ó','C Êù•ËøôÂÑøÂ∑•‰Ωú'] :
                                  (i === 33) ? ['A Ê≤°ËßÅËøáÈõ™','B ÊØèÂ§©ÈÉΩËÉΩÁúãÂà∞Èõ™','C ÂñúÊ¨¢Èõ™'] :
                                  (i === 34) ? ['A Âà∑ÁâôÁöÑÊó∂Èó¥Ë∂äÈïøË∂äÂ•Ω','B ÊØèÂ§©Âà∑‰∏§Ê¨°ÁâôÂ∞±ÂèØ‰ª•','C ÊØèÂπ¥ÈÉΩË¶ÅÂéªÂåªÈô¢Ê£ÄÊü•Áâô'] :
                                  ['A Â∑•‰ΩúÁâπÂà´Âøô','B ‰∏çÂñúÊ¨¢ËØ¥ËØù','C ‰∏ã‰∏™ÊúàÊê¨ÂÆ∂'];
                        optionsHtml = arr.map((txt, idx) => {
                            let val = String.fromCharCode(65 + idx);
                            return `<div class="option-item" onclick="selectOption(${i}, '${val}')">
                                <input type="radio" name="q${i}" value="${val}" ${userAnswers[i] === val ? 'checked' : ''}> ${txt}
                            </div>`;
                        }).join('');
                    } else if (i >= 36 && i <= 40) {
                        optionsHtml = `<input type="text" placeholder="ÂÜôÂè•Â≠ê..." value="${userAnswers[i] || ''}" onchange="userAnswers[${i}] = this.value">`;
                    } else if (i >= 41 && i <= 45) {
                        optionsHtml = `<input type="text" placeholder="ÂÜôÊ±âÂ≠ó..." value="${userAnswers[i] || ''}" onchange="userAnswers[${i}] = this.value">`;
                    } else if (i >= 46 && i <= 50) {
                        let opts = (i === 46) ? ['Á±≥','Êù•'] : (i === 47) ? ['Âßê','Â¶Ç'] : (i === 48) ? ['Êñ§','Ëøë'] : (i === 49) ? ['Êü•','È¶ô'] : ['Â∏Ω','ÂÜí'];
                        optionsHtml = opts.map(val => 
                            `<div class="option-item" onclick="selectOption(${i}, '${val}')">
                                <input type="radio" name="q${i}" value="${val}" ${userAnswers[i] === val ? 'checked' : ''}> ${val}
                            </div>`
                        ).join('');
                    }

                    html += `<div class="soal-card" id="soal-${i}">
                        <div class="soal-nomor">üìñ ${i}</div>
                        <div class="soal-text">${questionText}</div>
                        <div class="options">${optionsHtml}</div>
                    </div>`;
                }
            }
            html += '</div>';
            container.innerHTML = html;
        }

        function getReadingQuestionText(i) {
            const texts = {
                21: 'ËøòÊúâÂ§öËøúÔºüÊàëÁ¥ØÂæó‰∏ÄÊ≠•‰πü‰∏çÊÉ≥Ëµ∞‰∫Ü„ÄÇ',
                22: 'Â•πÂÑøÂ≠êÂè™Êúâ‰∏§‰∏™ÊúàÂ§ßÔºå‰∏çÁî®Á©øÁöÆÈûãÔºå‰π∞‰∏™Â∞èÂ∏ΩÂ≠êÂêß„ÄÇ',
                23: 'Â•ΩÔºå‰Ω†ÂùêËøôËæπÂêßÔºåÊàëÁªô‰Ω†Ê£ÄÊü•‰∏Ä‰∏ã„ÄÇ',
                24: 'ÂâçËæπÈÇ£‰∏™È´òÈ´òÁöÑ„ÄÅÁò¶Áò¶ÁöÑËÄÅ‰∫∫ÊòØË∞ÅÔºü',
                25: 'Ê≤°‰∫ãÔºåÂèØËÉΩÊòØÂ§ñËæπÂ§™ÂÜ∑‰∫ÜÔºåËøòÂàÆÂ§ßÈ£é„ÄÇ',
                26: 'ÊàëÊÑüÂÜí‰∫ÜÔºåÔºà Ôºâ‰∏çËàíÊúç„ÄÇ',
                27: 'ÊàëÔºà ÔºâÁé∞Âú®‰∏äÁΩëÁúãÊñ∞ÈóªÊØî‰ª•ÂâçÊñπ‰æøÂ§ö‰∫Ü„ÄÇ',
                28: '‰ªäÂ§©Ê¥óÊæ°ÁöÑÊó∂ÂÄôÊàëÂèëÁé∞ÊàëÁöÑÔºà ÔºâÈïø‰∫Ü‰∏çÂ∞ë„ÄÇ',
                29: 'AÔºöÊàëÁúã‰Ω†ÂíåÊñ∞Êù•ÁöÑÂ∞è‰∏ΩÊØèÂ§©‰∏ãÁè≠ÈÉΩ‰∏ÄËµ∑Ëµ∞„ÄÇBÔºöÊòØÔºåÊàë‰ª¨‰ª•ÂâçÂ∞±ÊòØÂêåÂ≠¶ÔºåÔºà Ôºâ‰∏ÄÁõ¥ÂæàÂ•Ω„ÄÇ',
                30: 'AÔºöÊúÄËøëÂ∑•‰ΩúÂ§™Á¥Ø‰∫ÜÔºåÊàëÁúüÊÉ≥Â•ΩÂ•ΩÂÑø‰ºëÊÅØ‰∏Ä‰∏ã„ÄÇBÔºöÈÇ£‰Ω†ÂéªÂà´ÁöÑÔºà ÔºâÁé©ÂÑøÁé©ÂÑøÂêß„ÄÇ',
                31: 'ÂÖ≥‰∫é‰ΩìÊ£ÄÔºåÂèØ‰ª•Áü•ÈÅì‰ªÄ‰πàÔºü',
                32: 'Â¶ÇÊûúËÆ§‰∏∫ËøôÂÆ∂È•≠Â∫óÁöÑÈ•≠Ëèú‰∏çÈîôÔºåÊàë‰ª¨ÂèØ‰ª•Ôºö',
                33: '‚òÖÊàëÔºö',
                34: 'Ê†πÊçÆËøôÊÆµËØùÔºåÂèØ‰ª•Áü•ÈÅì‰ªÄ‰πàÔºü',
                35: '‚òÖÊàë‰∏àÂ§´:',
                36: 'Ë∑≥ Ëµ∑Êù• È´òÂÖ¥ ÂºüÂºü Âæó‰∫Ü',
                37: 'Â§ß Â§ß Â∞èÁãó ÁöÑ ÁöÑ ÁúºÁùõ',
                38: 'Áé©ÂÑø Â§©Ê∞î Â∞± Êàë‰ª¨ ÊòéÂ§© ÂÖ¨Âõ≠ Âéª Â•Ω',
                39: 'Ëµ∞Ë∑Ø ‰∏çËÉΩ Áñº ËÖø Âæó ÊàëÁöÑ',
                40: 'Áîú ÁöÑ Áîú Ê∞¥ÊûúÂ∫ó ÁöÑ Ë•øÁìú',
                41: 'Ëøô‰∏™ ( ) Â∏ÇÁöÑË°óÈÅìÈùûÂ∏∏Âπ≤ÂáÄ, Ë∑ØËæπÊúâÂæàÂ§öÊ†ë„ÄÇ (ch√©ng)',
                42: 'Â¶ªÂ≠êÁü•ÈÅìÊàëÊòéÂ§©ÂèÇÂä†Èù¢ËØï, ‰∏∫Êàë‰π∞‰∫Ü‰∏ÄÂèåÊñ∞ ( ) Èûã„ÄÇ (pi)',
                43: 'ÂºüÂºüÁöÑÁúºÁùõÂ§ßÂ§ßÁöÑÔºåÔºà ÔºâÂ≠êÈ´òÈ´òÁöÑÔºåÂèØÁà±ÊûÅ‰∫Ü„ÄÇ',
                44: 'Áà∑Áà∑Â∑≤Áªè80Â≤Å‰∫ÜÔºåÊØèÂπ¥ÈÉΩË¶ÅÂéªÂÅö‰∏ÄÊ¨°ÂÅ•Â∫∑Ôºà ÔºâÊü•„ÄÇ (ji«én)',
                45: '‰Ω†ÂêÉ‰∫ÜÈÇ£‰πàÂ§öÁîú‰∏úË•øÔºåÂø´ÂéªÊääÔºà ÔºâÂà∑Âπ≤ÂáÄ„ÄÇ (y√°)',
                46: 'Â∞è‰∏ΩÊØèÂ§©Êó©‰∏äÈÉΩË¶ÅÂÖàÂéªÂÖ¨Âõ≠Ë∑ë‰∏§ÂçÉ ÔºåÂÜç ÂÖ¨Âè∏‰∏äÁè≠„ÄÇÔºàÁ±≥„ÄÅÊù•Ôºâ',
                47: 'Âë®Áßò‰π¶Ôºå ÊûúÁôΩÂ∞è ÂõûÊù•‰∫ÜÔºåËØ∑‰Ω†ËÆ©Â•πÁªôÊàëÊâì‰∏™ÁîµËØù„ÄÇÔºàÂßê„ÄÅÂ¶ÇÔºâ',
                48: 'ËøôÂÑøÈôÑ Êúâ‰∏™Ë∂ÖÂ∏ÇÔºåÊàë‰ª¨ËøõÂéª‰π∞Âá† Ê∞¥ÊûúÂêß„ÄÇÔºàÊñ§„ÄÅËøëÔºâ',
                49: 'ÂåªÁîüÊ£Ä ÂÆåÊàëÁöÑÁâôÂêéÔºåËÆ©ÊàëÂ∞ëÂêÉ‰∫õ Ëïâ„ÄÅËõãÁ≥ïËøôÊ†∑ÁîúÁöÑ‰∏úË•ø„ÄÇÔºàÊü•„ÄÅÈ¶ôÔºâ',
                50: 'Â§©Ê∞îË∂äÊù•Ë∂äÂÜ∑ÔºåÊàëÊÄï‰Ω†ÊÑü ÔºåÊâÄ‰ª•Áªô‰Ω†‰π∞‰∫Ü‰∏™ Â≠ê„ÄÇÔºàÂ∏Ω„ÄÅÂÜíÔºâ'
            };
            return texts[i] || `ÈóÆÈ¢ò ${i}`;
        }

        function playListening(no) {
            let text = listeningScript[no];
            if (!text) return;
            let utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'zh-CN';
            utterance.rate = 0.9;
            speechSynthesis.cancel();
            speechSynthesis.speak(utterance);
        }

        function selectOption(no, val) {
            userAnswers[no] = val;
            let radios = document.querySelectorAll(`input[name="q${no}"]`);
            radios.forEach(r => { if (r.value === val) r.checked = true; });
        }

        function submitAll() {
            clearInterval(timerInterval);
            let listeningBenar = 0, readingBenar = 0;
            for (let i = 1; i <= 20; i++) {
                let jawab = userAnswers[i];
                if (jawab && jawab === listeningJawaban[i]) listeningBenar++;
            }
            for (let i = 21; i <= 50; i++) {
                let jawab = userAnswers[i];
                if (!jawab) continue;
                let kunci = readingJawaban[i];
                if (i >= 36 && i <= 40) {
                    if (normalisasiKalimat(jawab) === normalisasiKalimat(kunci)) readingBenar++;
                } else if (i >= 41 && i <= 45) {
                    if (jawab.trim() === kunci) readingBenar++;
                } else {
                    if (jawab === kunci) readingBenar++;
                }
            }
            let totalBenar = listeningBenar + readingBenar;
            let persen = (totalBenar / 50 * 100).toFixed(2);
            let status = persen >= 85 ? '‚úÖ ÂèäÊ†º (ÈÄöËøá)' : '‚ùå ‰∏çÂèäÊ†º';
            let laporanHtml = `
                <h2>üìä ÊàêÁª©Âçï</h2>
                <p>üéß Âê¨Âäõ: ${listeningBenar}/20 Ê≠£Á°Æ</p>
                <p>üìñ ÈòÖËØª: ${readingBenar}/30 Ê≠£Á°Æ</p>
                <p>ÊÄªÊ≠£Á°Æ: ${totalBenar}/50 (${persen}%)</p>
                <p>${status}</p>
                <div class="footer">
                    <button class="btn-review" onclick="reviewAll()">üîç Ê£ÄÊü•ÊâÄÊúâÁ≠îÊ°à (Á∫¢ÈîôÁªøÂØπ)</button>
                </div>
            `;
            document.getElementById('laporanArea').innerHTML = laporanHtml;
            document.getElementById('laporanArea').style.display = 'block';
        }

        function reviewAll() {
            // Hapus highlight sebelumnya
            document.querySelectorAll('.soal-card').forEach(c => {
                c.classList.remove('wrong-highlight', 'correct-highlight');
            });
            // Loop semua soal 1-50
            for (let i = 1; i <= 50; i++) {
                let jawab = userAnswers[i];
                let kunci = (i <= 20) ? listeningJawaban[i] : readingJawaban[i];
                let benar = false;
                if (jawab) {
                    if (i >= 36 && i <= 40) {
                        if (normalisasiKalimat(jawab) === normalisasiKalimat(kunci)) benar = true;
                    } else if (i >= 41 && i <= 45) {
                        if (jawab.trim() === kunci) benar = true;
                    } else {
                        if (jawab === kunci) benar = true;
                    }
                }
                let el = document.getElementById(`soal-${i}`);
                if (el) {
                    if (benar) {
                        el.classList.add('correct-highlight');
                    } else {
                        el.classList.add('wrong-highlight');
                    }
                }
            }
        }

        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(updateTimer, 1000);
        }

        function updateTimer() {
            if (timeLeft <= 0) {
                clearInterval(timerInterval);
                document.getElementById('timerDisplay').textContent = '00:00';
                alert('Êó∂Èó¥Âà∞ÔºÅËØ∑Êèê‰∫§Á≠îÊ°à„ÄÇ');
                return;
            }
            timeLeft--;
            let minutes = Math.floor(timeLeft / 60);
            let seconds = timeLeft % 60;
            document.getElementById('timerDisplay').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function switchTab(tab) {
            document.getElementById('tabListening').classList.toggle('active', tab === 'listening');
            document.getElementById('tabReading').classList.toggle('active', tab === 'reading');
            document.getElementById('listeningPanel').style.display = tab === 'listening' ? 'block' : 'none';
            document.getElementById('readingPanel').style.display = tab === 'reading' ? 'block' : 'none';
        }

        window.startApp = function() {
            let nameInput = document.getElementById('userNameInput').value.trim();
            if (nameInput === '') {
                alert('ËØ∑ËæìÂÖ•ÊÇ®ÁöÑÂêçÂ≠óÔºÅ');
                return;
            }
            userName = nameInput;
            document.getElementById('identityOverlay').style.display = 'none';
            // Inisialisasi urutan acak
            initShuffledOrders();
            // Render ulang
            renderListening();
            renderReading();
            startTimer();
        };

        // Ekspose fungsi global
        window.switchTab = switchTab;
        window.selectOption = selectOption;
        window.playListening = playListening;
        window.submitAll = submitAll;
        window.reviewAll = reviewAll;
    })();
</script>
</body>
</html>